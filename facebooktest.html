<!DOCTYPE html>
<html>
<head>
<title>Facebook Login JavaScript Example</title>
<meta charset="UTF-8">
</head>
<body>
<script>

  function sendAccessTokenToServer(accessToken) {
    // Create a new form data object
    var formData = new FormData();
    formData.append('access_token', accessToken);

    // Create a new XMLHttpRequest object
    var xhr = new XMLHttpRequest();
    xhr.open('POST', 'https://x8ki-letl-twmt.n7.xano.io/api:9oHx-ps9/fb_access_token', true);
    xhr.onload = function() {
      // Handle the response from the server
      if (xhr.status === 200) {
        console.log('Access token sent successfully!');
        // Disable the button and change text
        document.getElementById('connectButton').disabled = true;
        document.getElementById('connectButton').innerHTML = 'Connected';
      } else {
        console.log('Error sending access token.');
      }
    };
    xhr.send(formData);
  }

  function connectToFacebook() {
    FB.login(function(response) {
      if (response.authResponse) {
        console.log('Access token obtained: ' + response.authResponse.accessToken);
        // Send the access token to the server
        sendAccessTokenToServer(response.authResponse.accessToken);
      } else {
        console.log('User cancelled login or did not fully authorize.');
      }
    }, { scope: 'public_profile,email' });
  }

  window.fbAsyncInit = function() {
    FB.init({
      appId      : '565727642299403',
      cookie     : true,                     // Enable cookies to allow the server to access the session.
      xfbml      : true,                     // Parse social plugins on this webpage.
      version    : 'v17.0'           // Use this Graph API version for this call.
    });
  };
 
</script>

<!-- The Connect to Facebook Button -->
<button id="connectButton" onclick="connectToFacebook()">Connect to Facebook</button>

<!-- Load the JS SDK asynchronously -->
<script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js"></script>
</body>
</html>